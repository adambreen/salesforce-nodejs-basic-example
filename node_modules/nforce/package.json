{
  "author": {
    "name": "Kevin O'Hara",
    "email": "kevnohara80@gmail.com",
    "url": "http://kevinmohara.com"
  },
  "name": "nforce",
  "description": "nforce is a REST API wrapper for force.com, database.com, and salesforce.com",
  "version": "0.2.0",
  "keywords": [
    "salesforce",
    "force.com",
    "database.com",
    "sfdc",
    "forcedotcom"
  ],
  "repository": {
    "type": "git",
    "url": "git://github.com/kevinohara80/nforce.git"
  },
  "main": "index.js",
  "dependencies": {
    "request": "*",
    "faye": "~0.8.3"
  },
  "devDependencies": {
    "mocha": "*",
    "should": "*"
  },
  "optionalDependencies": {},
  "engines": {
    "node": "*"
  },
  "bugs": {
    "url": "http://github.com/kevinohara80/nforce/issues"
  },
  "scripts": {
    "test": "mocha --reporter spec"
  },
  "license": {
    "type": "MIT",
    "url": "https://raw.github.com/kevinohara80/nforce/master/LICENSE"
  },
  "readme": "nforce\n======\n\n[![Build Status](https://secure.travis-ci.org/kevinohara80/nforce.png)](http://travis-ci.org/kevinohara80/nforce)  \n\n**nforce** is node.js a REST API wrapper for force.com, database.com, and salesforce.com.\n\n## Features\n\n* Simple api\n* Helper oauth methods\n* Express middleware\n* Streaming queries\n\n## Installation\n\n```bash\n$ npm install nforce\n```\n\n## Usage\n\nRequire **nforce** in your app and create a connection to an org.\n\n```js\nvar nforce = require('nforce');\n\nvar org = nforce.createConnection({\n  clientId: 'SOME_OAUTH_CLIENT_ID',\n  clientSecret: 'SOME_OAUTH_CLIENT_SECRET',\n  redirectUri: 'http://localhost:3000/oauth/_callback',\n  apiVersion: 'v24.0',  // optional, defaults to v24.0\n  environment: 'production'  // optional, sandbox or production, production default\n});\n```\n\nNow we just need to authenticate and get our OAuth credentials. Here is one way...\n\n```js\nvar oauth;\n\norg.authenticate({ username: 'my_test@gmail.com', password: 'mypassword'}, function(err, resp){\n  if(!err) oauth = resp;\n});\n```\n\nNow we can go nuts. **nforce** has an sObject factory method that creates records for you. Let's use that and insert a record...\n\n```js\nvar acc = nforce.createSObject('Account');\nacc.Name = 'Spiffy Cleaners';\nacc.Phone = '800-555-2345';\nacc.SLA__c = 'Gold';\n\norg.insert(acc, oauth, function(err, resp){\n  if(!err) console.log('It worked!');\n});\n```\n\nQuerying and updating records is super easy. **nforce** wraps API-queried records in a special object. The object caches field updates that you make to the record and allows you to pass the record directly into the update method without having to scrub out the unchanged fields. In the example below, only the Name and Industry fields will be sent in the update call despite the fact that the query returned other fields such as BillingCity and CreatedDate.\n\n```js\nvar query = 'SELECT Id, Name, CreatedDate, BillingCity FROM Account WHERE Name = \\'Spiffy Cleaners\\' LIMIT 1';\n\norg.query(query, oauth, function(err, resp){\n  \n  if(!err && resp.records) {\n    \n    var acc = resp.records[0];\n    acc.Name = 'Really Spiffy Cleaners';\n    acc.Industry = 'Cleaners';\n    \n    org.update(acc, oauth, function(err, resp){\n      if(!err) console.log('It worked!');\n    });\n    \n  } \n});\n```\n\n## Authentication\n\n**nforce** supports two OAuth 2.0 flows, username/password and authorization code.\n\n### Username/Password flow\n\nTo request an access token and other oauth information using the username and password flow, use the `authenticate()` method and pass in your username and password in the options\n\n```js\nvar oauth;\n\norg.authenticate({ username: 'my_test@gmail.com', password: 'mypassword'}, function(err, resp){\n  if(!err) {\n    console.log('Access Token: ' + resp.access_token);\n    oauth = resp;\n  } else {\n    console.log('Error: ' + err.message);\n  }\n});\n```\n\n### Authorization Code Flow\n\nTo perform an authorization code flow, first redirect users to the Authorization URI at Salesforce. **nforce** provides a helper function to build this url for you.\n\n```js\norg.getAuthUri()\n```\n\nOnce you get a callback at the Redirect URI that you specify, you need to request your access token and other important oauth information by calling `authenticate()` and passing in the \"code\" that you received.\n\n```js\nvar oauth;\n\norg.authenticate({ code: 'SOMEOAUTHAUTHORIZATIONCODE' }, function(err, resp){\n  if(!err) {\n    console.log('Access Token: ' + resp.access_token);\n    oauth = resp;\n  } else {\n    console.log('Error: ' + err.message);\n  }\n});\n```\n\n### OAuth Object\n\nAt the end of a successful authorization, you a returned an OAuth object for the user. Cache this object as it will be used for subsequent requests. This object contains your access token, endpoint, id, and other information. \n\nWhy is this not automatically stored as a global variable? This is because you can have multiple users accessing your application and each user will have their own OAuth credentials from Salesforce. In this scenario, it makes the most sense to store these credentials in the users session or in some other data store. If you are using [express](https://github.com/visionmedia/express), **nforce** can take care of storing this for you (see below).\n\n### Express Middleware\n\n**nforce** has built-in support for [express](https://github.com/visionmedia/express) using the express/connect middleware system. The middleware handles the oauth callbacks for you. To use the middleware you must have sessions enabled in your express configuration.\n\n```js\napp.configure(function(){\n  app.set('views', __dirname + '/views');\n  app.set('view engine', 'jade');\n  app.use(express.bodyParser());\n  app.use(express.methodOverride());\n  app.use(express.cookieParser());\n  app.use(express.session({ secret: 'nforce testing baby' }));\n  app.use(org.expressOAuth({onSuccess: '/home', onError: '/oauth/error'}));  // <--- nforce middleware\n  app.use(app.router);\n  app.use(express.static(__dirname + '/public'));\n});\n```\n\n### Query Streaming API\n\nThe Salesforce query call in the REST API returns a 2000 record chunk at one time. The example below shows a normal query returning 2000 records only.\n\n```js\n// dataset of 50k records.\nvar query = 'SELECT Name, CreatedDate FROM Account ORDER BY CreatedDate DESC';\norg.query(query, req.session.oauth, callback(err, resp) {\n  if(!err) console.log(resp.records.length) // this will be 2000 max\n});\n```\n\nThe **nforce** query method returns a node stream. By calling the `pipe` method on this object, your query call will automatically start streaming ALL of the records from your query in 2000 record batches.\n\n```js\n// dataset of 50k records.\nvar query = 'SELECT Name, CreatedDate FROM Account ORDER BY CreatedDate DESC';\norg.query(query, req.session.oauth).pipe(res); // streaming all 50k records\n``` \n\n## nforce API\n\n### Callbacks\n\nCallbacks will always pass an optional error object, and a response object. The response object closely resemble the typical responses from the Salesforce REST API.\n\n```js\ncallback(err, resp);\n```\n\n### createConnection(opts)\n\nThe createConnection method creates an *nforce* connection object. You need to supply some arguments including oauth information and some optional arguments for version and environment.\n\n* `clientId`: Required. This is the OAuth client id\n* `clientSecret`: Required. This is the OAuth client secret\n* `redirectUri`: Required. This is the redirect URI for OAuth callbacks\n* `apiVersion`: Optional. This is a number or string representing a valid REST API version. Default is v24.0.\n* `environment`: Optional. Values can be 'production' or 'sandbox'. Default is production.\n\n### createSObject(type, [fieldValues])\n\nThis creates an sObject record that you can use to insert, update, upsert, and delete. `type` should be the API name of the sObject that you are updating. `fieldValues` should be a hash of field names and values that you want to initialize your sObject with. You can also just assign fields and values by setting properties after you create the sObject.\n\n## sObject Methods\n\n### getFieldValues()\n\nThis method shows the cached values that have been updated that will be passed in an update or upsert method\n\n### setExternalId(field, value)\n\nFor upsert methods, you need to specify the External Id field and the value that you are trying to match on.\n\n### getId()\n\nReturns the sObjects Id (if set)\n\n## Connection Methods\n\nThe following list of methods are available for an **nforce** connection object:\n\n### getAuthUri()\n\nThis is a helper method to build the authentication uri for a authorization code OAuth 2.0 flow.\n\n### authenticate(opts, callback)\n\nThis method requests the OAuth access token and instance information from Salesforce. This method either requires that you pass in the authorization code (authorization code flow) or username and password (username/password flow).\n\n* `code`: (String) An OAuth authorization code\n\n-- OR --\n\n* `username`: (String) Your salesforce/force.com/database.com username\n* `password`: (String) Your salesforce/force.com/database.com password\n* `securityToken`: (String) Your Salesforce security token. This will be appended to your password if this property is set.\n\n### expressOAuth(onSuccess, onError)\n\nThe express middleware. `onSuccess` and `onError` should be uri routes for redirection after OAuth callbacks.\n\n### getVersions(callback)\n\nGets the salesforce versions. Note: Does not require authentication.\n\n### getResources(oauth, callback)\n\nGets the available resources\n\n### getSObjects(oauth, callback)\n\nGet all sObjects for an org\n\n### getMetadata(type, oauth, callback)\n\nGet metadata for a single sObject. `type` is a required String for the sObject type\n\n### getDescribe(type, oauth, callback)\n\nGet describe information for a single sObject. `type` is a required String for the sObject type\n\n### insert(sobject, oauth, callback)\n\nInsert a record. `sobject`: (Object) A Salesforce sObject\n\n### update(sobject, oauth, callback)\n\nUpdate a record. `sobject`: (Object) A Salesforce sObject\n\n### upsert(sobject, oauth, callback)\n\nUpdate a record. `sobject`: (Object) A Salesforce sObject. NOTE: you must use the setExternalId() method to set the external Id field and the value to match on.\n\n### delete(sobject, oauth, callback)\n\nDelete a record. `sobject`: (Object) A Salesforce sObject\n\n### getRecord(sobject, oauth, callback)\n\nGet a single record. `sobject`: (Object) A Salesforce sObject\n\n### query(query, oauth, [callback])\n\nExecute a SOQL query for records. `query` should be a SOQL string. Large queries can be streamed using the `pipe()` method.\n\n### search(search, oauth, callback)\n\nExecute a SOSL search for records. `search` should be a SOSL string.\n\n### getUrl(url, oauth, callback)\n\nGet a REST API resource by its url. `url` should be a REST API resource.\n\n### stream(pushtopic, oauth)\n\nStart a streaming connection. An EventEmitter is returned with the following events:\n\n* `connect`: subscribed to the topic\n* `data`: got a streaming event\n* `error`: there was a problem with the subscription\n\n## Todo\n\n* **nforce** cli implementation\n* Streaming API support\n* Blob data support\n* User password management\n* Continue with caching capabilities for describe/metadata calls\n* Chatter support\n\n## Contributors\n\n* Kevin O'Hara -> [kevinohara80](https://github.com/kevinohara80)\n* Jeff Douglas -> [jeffdonthemic](https://github.com/jeffdonthemic)\n\n## Changelog\n\n* `v0.2.0`: Adding streaming support\n* `v0.1.1`: Fixes auth error handling bug\n* `v0.1.0`: Releasing 0.1.0!\n* `v0.0.7`: Bug fixes\n* `v0.0.6`: Query streaming\n* `v0.0.5`: Bug fixes\n* `v0.0.4`: Initialization of SObject now has field setting option\n* `v0.0.3`: API overhaul. Implemented Record class with field update caching\n* `v0.0.2`: Testing framework implemented. Bug fixes.\n* `v0.0.1`: Initial release. OAuth, CRUD, describes",
  "_id": "nforce@0.2.0",
  "dist": {
    "shasum": "c4ae18c47ecd36684b22d7741b2cb75831764aa1"
  },
  "_from": "nforce"
}
